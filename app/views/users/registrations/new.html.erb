<section class="section">
  <header class="header header--title">
    <h1> AlbumPloc  </h1>
  </header>
  <div class="container container--xs">

    <%= render "users/shared/error_messages", resource: resource %>
    <div class="container">
      <%= link_to "Login", new_user_session_path, method: :get, class: "btn btn--nav"%>
      <button class="btn btn--nav btn--nav--active">SignUp</button>
    </div>
    <%= form_for(resource, as: resource_name, url: registration_path(resource_name),  data: { turbo: false }, local: true, :html => {:class => "form"}) do |f| %>
      <%= render "users/shared/error_messages", resource: resource %>

      <div class="field form__field">
        <%= f.label :email %><br />
        <%= f.email_field :email, class:"form__input", autofocus: true, autocomplete: "email", placeholder:"example@email.com", required: true %>
      </div>

      <div class="field form__field">
        <%= f.label :password %>
        <% if @minimum_password_length %>
        <em>(<%= @minimum_password_length %> characters minimum)</em>
        <% end %><br />
        <%= f.password_field :password, id:"form__field__password", class:"form__input", autocomplete: "new-password", placeholder:"password", required: true, minlength: "6"%>
        <div id="minimum_password_length" class="form__error"></div>
      </div>

      <div class="field form__field">
        <%= f.label :password_confirmation %><br />
        <%= f.password_field :password_confirmation, id:"form__field__password__confirmation", class:"form__input", autocomplete: "new-password", placeholder:"password", required: true, minlength: "6"%>
        <div id="password_confirmation" class="form__error"></div>
      </div>

      <div class="actions form__action form__action--spaced ">
        <%= f.submit "Sign up", class:"btn btn--primary", id:"form__action__submit"%>
      </div>
    <% end %>
    <%= render "users/shared/links" %>
  </div>
</section>
<%= render "users/shared/footer-basic"%>

<script>
const passwordConfirmationField = document.getElementById("form__field__password__confirmation");
const passwordField = document.getElementById("form__field__password");

passwordConfirmationField.addEventListener("input", function() {
  if (passwordConfirmationField.value !== passwordField.value) {
    passwordConfirmationField.setCustomValidity("Passwords do not match");
    document.querySelector("#form__action__submit").disabled = true;
    document.getElementById("password_confirmation").innerHTML = passwordConfirmationField.validationMessage;
  } else {
    passwordConfirmationField.setCustomValidity("");
    document.querySelector("#form__action__submit").disabled = false;
  }
});
</script>
